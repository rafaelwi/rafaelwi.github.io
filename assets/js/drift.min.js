class MyGamepadButton{constructor(t,e,i,n){this.id=t,this.svgID=document.getElementById(e),this.onSuccess=i.bind(this),this.onFailure=n.bind(this)}setFillColour(t){this.svgID.setAttribute("fill",t)}setFillOpacity(t){this.svgID.setAttribute("fill-opacity",t)}setBorderStyle(t){this.svgID.style.border=t}}var gpi=document.getElementById("gp-info"),gpb=document.getElementById("gp-btns"),lt=document.getElementById("gp6"),rt=document.getElementById("gp7"),leftJoystick=document.getElementById("left-joystick-pos"),rightJoystick=document.getElementById("right-joystick-pos"),buttons=[new MyGamepadButton(0,"gp0",function(){this.setFillOpacity("1")},function(){this.setFillOpacity("0.25")}),new MyGamepadButton(1,"gp1",function(){this.setFillOpacity("1")},function(){this.setFillOpacity("0.25")}),new MyGamepadButton(2,"gp2",function(){this.setFillOpacity("1")},function(){this.setFillOpacity("0.25")}),new MyGamepadButton(3,"gp3",function(){this.setFillOpacity("1")},function(){this.setFillOpacity("0.25")}),new MyGamepadButton(4,"gp4",function(){this.setFillColour("gray")},function(){this.setFillColour("lightgray")}),new MyGamepadButton(5,"gp5",function(){this.setFillColour("gray")},function(){this.setFillColour("lightgray")}),new MyGamepadButton(8,"gp8",function(){this.setFillColour("gray")},function(){this.setFillColour("lightgray")}),new MyGamepadButton(9,"gp9",function(){this.setFillColour("gray")},function(){this.setFillColour("lightgray")}),new MyGamepadButton(10,"left-joystick-pos",function(){this.setBorderStyle("5px solid black")},function(){this.setBorderStyle("5px solid lightgray")}),new MyGamepadButton(11,"right-joystick-pos",function(){this.setBorderStyle("5px solid black")},function(){this.setBorderStyle("5px solid lightgray")}),new MyGamepadButton(12,"gp12",function(){this.setFillColour("chartreuse")},function(){this.setFillColour("lightgray")}),new MyGamepadButton(13,"gp13",function(){this.setFillColour("chartreuse")},function(){this.setFillColour("lightgray")}),new MyGamepadButton(14,"gp14",function(){this.setFillColour("chartreuse")},function(){this.setFillColour("lightgray")}),new MyGamepadButton(15,"gp15",function(){this.setFillColour("chartreuse")},function(){this.setFillColour("lightgray")}),new MyGamepadButton(16,"gp16",function(){this.setFillColour("gray")},function(){this.setFillColour("lightgray")})],gpbs="",haveEvents="GamepadEvent"in window,haveWebkitEvents="WebKitGamepadEvent"in window,reqAniFrame=window.mozRequestAnimationFrame||window.requestAnimationFrame,gamepads=[],axesNames=["Left Stick x-axis","Left Stick y-axis","Right Stick x-axis","Right Stick y-axis"],buttonNames=["A Button","B Button","X Button","Y Button","LB","RB","LT","RT","Select","Start","Left Stick Pressed","Right Stick Pressed","Up","Down","Left","Right","Menu"];function gamepadConnectionHandler(t,e){var i=t.gamepad;e?(gamepads[i.index]=i,gpi.innerHTML="Gamepad #"+i.index+": "+i.id+" connected! "+i.buttons.length+" buttons and "+i.axes.length+" axes",document.getElementById("testVibrate").setAttribute("onClick","vibrate(gamepads[0], 1.0)"),document.getElementById("testVibrate").removeAttribute("hidden"),reqAniFrame(updateGamepadStatus)):(gpi.innerHTML="Gamepad #"+i.index+": "+i.id+" disconnected",delete gamepads[i.index])}function updateGamepadStatus(){for(gp of(gpbs="",scanForGamepads(),gamepads)){for([i,a]of gp.axes.entries())gpbs+="<b>"+axesNames[i]+": </b>"+(a<0?"":"+")+a.toFixed(6)+"&nbsp;&nbsp;&nbsp;&nbsp;";for([i,b]of(gpbs+="<br>",gp.buttons.entries())){b;"object"==typeof b&&(b.pressed,val=b.value),gpbs+="<b>"+buttonNames[i]+": </b>",gpbs+=6==i||7==i?b.value.toFixed(6):b.value,gpbs+=3==i||7==i||11==i?"<br>":"&nbsp;&nbsp;&nbsp;&nbsp;"}for([i,e]of(leftJoystick.style.left=calcJoystick(gp.axes[0]),leftJoystick.style.top=calcJoystick(gp.axes[1]),rightJoystick.style.left=calcJoystick(gp.axes[2]),rightJoystick.style.top=calcJoystick(gp.axes[3]),gp.axes[0]>-.01&&gp.axes[0]<.01&&gp.axes[1]>-.01&&gp.axes[1]<.01?leftJoystick.style.background="chartreuse":gp.axes[0]>-.05&&gp.axes[0]<.05&&gp.axes[1]>-.05&&gp.axes[1]<.05?leftJoystick.style.background="gold":-1==gp.axes[0]||1==gp.axes[0]||-1==gp.axes[1]||1==gp.axes[1]?leftJoystick.style.background="red":leftJoystick.style.background="white",gp.axes[2]>-.01&&gp.axes[2]<.01&&gp.axes[3]>-.01&&gp.axes[3]<.01?rightJoystick.style.background="chartreuse":gp.axes[2]>-.05&&gp.axes[2]<.05&&gp.axes[3]>-.05&&gp.axes[3]<.05?rightJoystick.style.background="gold":-1==gp.axes[2]||1==gp.axes[2]||-1==gp.axes[3]||1==gp.axes[3]?rightJoystick.style.background="red":rightJoystick.style.background="white",gp.buttons[0].value>0&&gp.buttons[6].value>0&&vibrate(gp,gp.buttons[6].value),lt.setAttribute("fill-opacity",gp.buttons[6].value),rt.setAttribute("fill-opacity",gp.buttons[7].value),buttons.entries()))1==gp.buttons[e.id].value?e.onSuccess():e.onFailure()}gpb.innerHTML=gpbs,reqAniFrame(updateGamepadStatus)}function scanForGamepads(){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],e=0;e<t.length;e++)t[e]&&t[e].index in gamepads&&(gamepads[t[e].index]=t[e])}function vibrate(t,e){t&&t.vibrationActuator&&t.vibrationActuator.playEffect("dual-rumble",{startDelay:0,duration:1e3,weakMagnitude:e,strongMagnitude:e})}function calcJoystick(t){return 50*t+50+"%"}haveEvents?(console.log("haveEvents"),window.addEventListener("gamepadconnected",function(t){gamepadConnectionHandler(t,!0)}),window.addEventListener("gamepaddisconnected",function(t){gamepadConnectionHandler(t,!1)})):haveWebkitEvents?(console.log("haveWebkitEvents"),window.addEventListener("webkitgamepadconnected",function(t){gamepadConnectionHandler(t,!0)}),window.addEventListener("webkitgamepaddisconnected",function(t){gamepadConnectionHandler(t,!1)})):setInterval(scanForGamepads,500);